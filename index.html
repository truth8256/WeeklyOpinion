<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°ì´í„° í”„ë ˆì  í…Œì´ì…˜ ìŠ¬ë¼ì´ë“œ (ì´ 11í˜ì´ì§€)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');

        /* =========================================================
            0) Base
        ========================================================= */
        body {
            font-family: 'Pretendard', sans-serif;
            font-size: 15px;
            background-color: #f0f2f5;

            display: flex;
            justify-content: center;
            align-items: center;

            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        /* =========================================================
            1) Layout: Wrapper / Slide Container
        ========================================================= */
        .presentation-wrapper {
            width: 1280px;
            height: 720px;
            position: relative;
        }

        .slide-container {
            width: 100%;
            height: 100%;
            background-color: #fff;

            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 30px;
            box-sizing: border-box;

            display: flex;
            flex-direction: column;

            position: absolute;
            top: 0;
            left: 0;

            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .slide-container.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        /* =========================================================
            2) Navigator (outside bottom-right)
        ========================================================= */
        .slide-navigator {
            position: absolute;
            bottom: -40px;
            right: 0;

            display: flex;
            align-items: center;
            gap: 10px;

            z-index: 20;
        }

        .nav-arrow {
            background: none;
            border: 1px solid #ddd;
            border-radius: 50%;

            width: 34px;     /* ì´ì „ 30px -> ì¡°ê¸ˆ í™•ëŒ€ */
            height: 34px;    /* ì´ì „ 30px -> ì¡°ê¸ˆ í™•ëŒ€ */
            font-size: 18px; /* ì´ì „ 16px -> ì¡°ê¸ˆ í™•ëŒ€ */
            font-weight: 700;
            color: #495057;

            cursor: pointer;
            transition: all 0.2s;

            display: flex;
            justify-content: center;
            align-items: center;
            line-height: 1;
        }

        .nav-arrow:hover:not(:disabled) {
            background-color: #e9ecef;
            border-color: #c0c0c0;
        }

        .nav-arrow:disabled {
            color: #ccc;
            cursor: default;
            border-color: #eee;
        }

        #page-indicator {
            font-size: 14px;
            color: #666;
        }

        /* =========================================================
            3) Common Header / Titles / Controls
        ========================================================= */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;

            margin-bottom: 15px;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 10px;
        }

        .title {
            font-size: 28px;
            font-weight: 800;
            color: #1a1a1a;
            letter-spacing: -0.01em;
        }

        .subtitle {
            font-size: 16px;
            color: #666;
        }

        .controls {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background-color: #f8f9fa;
            border-radius: 20px;

            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.2s;
        }

        .btn:hover {
            background-color: #e9ecef;
        }

        .btn.active {
            background-color: #0056b3;
            color: #fff;
            border-color: #0056b3;
        }

        /* =========================================================
            4) Chart Area (flex-safe for canvas)
        ========================================================= */
        .chart-wrapper {
            flex-grow: 1;
            position: relative;
            width: 100%;
            height: 100%;

            display: flex;
            flex-direction: column;
            min-height: 0;

            padding-top: 6px;     /* ì•½ê°„ì˜ ìˆ¨í†µ */
            padding-bottom: 6px;  /* ì•½ê°„ì˜ ìˆ¨í†µ */
        }

        .chart-canvas-box {
            flex: 1 1 auto;
            min-height: 0;
            position: relative;
        }

        .data-source {
            flex: 0 0 auto;
            margin-top: 6px;
            font-size: 11px; /* 12 -> 11: ì¡´ì¬ê°ì€ ë‚®ì¶”ê³ , ì •ë³´ëŠ” ìœ ì§€ */
            color: #888;
            text-align: right;
            width: 100%;
            padding-top: 10px;
            opacity: 0.9;
        }

        /* =========================================================
            5) Policy Slides (ìë¦½ì²­ë…„ ìŠ¬ë¼ì´ë“œ)
        ========================================================= */
        .policy-slide .header {
            border-bottom: 2px solid #333;
        }

        .policy-slide .title-main {
            font-size: 36px;
            font-weight: 900;
            color: #1a1a1a;
            margin-bottom: 10px;
            letter-spacing: -0.01em;
        }

        .policy-slide .title-sub {
            font-size: 20px;
            color: #555;
            font-weight: 600;
        }

        .policy-item {
            background: #e0f2fe;
            padding: 20px;
            border-radius: 8px;
            border-left: 5px solid #3b82f6;
            margin-bottom: 18px;
        }

        .policy-item h3 {
            margin: 0 0 6px 0;
            color: #1e3a8a;
            font-size: 20px;
            font-weight: 700;
        }

        /* ë³¸ë¬¸ ê°€ë…ì„±: ì¤‘ë³µ ì„ ì–¸ ì œê±° í›„ í•˜ë‚˜ë¡œ í†µì¼ */
        .policy-item p {
            font-size: 17px;
            margin: 6px 0 0 0;
            color: #333;

            line-height: 1.55;
            max-width: 820px;
            white-space: normal;
            word-break: keep-all;
        }

        .policy-item strong {
            font-weight: 700;
            color: #1d4ed8;
        }

        .policy-item ul {
            margin: 10px 0 0 24px;
            padding-left: 14px;      /* â† ë¶ˆë¦¿ê³¼ í…ìŠ¤íŠ¸ ê°„ ê±°ë¦¬ */
            line-height: 1.55;
            max-width: 800px;
            list-style-position: outside;
        }

        .policy-item li {
            margin: 6px 0;
            padding-left: 2px;  
            font-size: 15px; /* pì™€ ë™ì¼ ìŠ¤ì¼€ì¼ */
            color: #333;
            word-break: keep-all;
        }

        /* policy-solution ìŠ¬ë¼ì´ë“œ: ì¶œì²˜ë¥¼ í•­ìƒ ë§¨ ì•„ë˜ë¡œ */
        .policy-solution-body {
            display: flex;
            flex-direction: column;
            flex: 1 1 auto;
            min-height: 0;
        }

        .policy-solution-source {
            margin-top: auto;
        }

        /* =========================================================
            6) Risk Slide (9ìª½ ì „ìš© ë ˆì´ì•„ì›ƒ)
        ========================================================= */
        .risk-grid {
            display: grid;
            grid-template-columns: 3fr 1.1fr;
            gap: 16px;
            height: 100%;
        }

        /* ì¢Œì¸¡: ì°¨íŠ¸ ì˜ì—­ */
        .risk-charts {
            display: grid;
            grid-template-rows: 1fr; /* í•„ìš”ì‹œ 1fr 1fr ë¡œ ë°”ê¾¸ë©´ 2ê°œ ìœ„/ì•„ë˜ */
            gap: 12px;
            min-height: 0;
        }

        .risk-chart-box {
            position: relative;
            width: 100%;
            height: 100%;
            min-height: 0;
        }

        /* ì •ì±… ì‚¬ê°ì§€ëŒ€ ìŠ¬ë¼ì´ë“œ: ì°¨íŠ¸ ë†’ì´ ì¤„ì´ê¸° */
        #policy-welfare-slide .chart-wrapper{
        max-height: 460px;   /* ê¸°ì¡´ë³´ë‹¤ ì‘ê²Œ */
        margin-top: 10px;
        }

        /* ìš°ì¸¡ ì¹´ë“œ */
        .risk-side {
            display: flex;
            flex-direction: column;
            gap: 12px;
            justify-content: center;
        }

        .risk-card {
            text-align: center;
            padding: 18px;
            border-radius: 8px;
            border: 1px solid;
        }

        .risk-card-red {
            background: #ffe0e0;
            border-color: #ff9999;
            color: #cc0000;
        }

        .risk-card-blue {
            background: #e0f8ff;
            border-color: #99d8ff;
            color: #004466;
        }

        .risk-card h3 {
            font-size: 18px;
            margin: 0;
        }

        .risk-big {
            font-size: 28px;
            font-weight: 700;
            margin: 6px 0 0 0;
        }

        .risk-sub {
            font-size: 13px;
            margin: 0;
        }

        .yk-wrap{
        height: 100%;
        display: flex;
        flex-direction: column;
        min-height: 0;
        }

        .yk-titlebar{
        display:flex;
        justify-content: space-between;
        align-items: flex-end;
        margin-bottom: 18px;
        border-bottom: 2px solid #333;
        padding-bottom: 10px;
        }

        .yk-title{
        font-size: 28px;
        font-weight: 800;
        color:#111;
        }

        /* slide-yk-1 (center title layout) */
        .yk-center{
        flex: 1 1 auto;
        display: flex;
        align-items: center;      /* ì„¸ë¡œ ì¤‘ì•™ */
        justify-content: center;  /* ê°€ë¡œ ì¤‘ì•™ */
        min-height: 0;
        }
        .yk-mainword{
        font-size: 64px;
        font-weight: 900;
        letter-spacing: -0.02em;
        color:#111;
        }
        .yk-subcopy{
        font-size: 18px;
        line-height: 1.55;
        color:#333;
        max-width: 980px;
        word-break: keep-all;
        }
        /* slide-yk-1ì—ì„œë§Œ: ë©”ì¸ì¹´í”¼ ì•„ë˜ë¡œ ì„œë¸Œì¹´í”¼ ë‚´ë ¤ì˜¤ê¸° */
        #slide-yk-1 .yk-center{
        display: flex;
        flex-direction: column;     /* âœ… ì„¸ë¡œ ë°°ì¹˜ */
        align-items: center;        /* âœ… ê°€ë¡œ ì¤‘ì•™ */
        justify-content: center;    /* âœ… ì„¸ë¡œ ì¤‘ì•™(ìŠ¬ë¼ì´ë“œ ê°€ìš´ë° ìœ ì§€) */
        gap: 14px;                  /* âœ… ë©”ì¸-ì„œë¸Œ ê°„ê²© */
        text-align: center;         /* âœ… ì„œë¸Œì¹´í”¼ ì¤‘ì•™ ì •ë ¬ */
        }

        /* (ì„ íƒ) ì„œë¸Œì¹´í”¼ ê°€ë…ì„±/í­ ì œí•œ */
        #slide-yk-1 .yk-subcopy{
        max-width: 860px;
        line-height: 1.5;
        }

        /* slide-yk-2 & 3 boxes */
        .yk-grid{
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 28px;
        width: 100%;
        max-width: 1100px;    
        }
        /* slide-yk-3ì—ì„œë§Œ: row ë†’ì´ ê°•ì œ ëŠ˜ì–´ë‚¨ ë°©ì§€ */
        #slide-yk-3 .yk-grid{
        align-items: start;
        }

        .yk-box{
        background: #e0f2fe;
        border-radius: 10px;
        padding: 18px;
        text-align: center;
        }

        .yk-box strong{
        display: block;
        font-size: 16px;
        font-weight: 800;
        margin-bottom: 6px;
        }

        .yk-box span{
        font-size: 14px;
        color: #444;
        line-height: 1.4;
        }

        /* ê¸°íƒ€ ì·¨ì•½ ì²­ë…„ */
        .yk-box-muted{
        background: #f3f4f6;
        border: 1px dashed #bbb;
        }
        /* slide-yk-3: ì˜¤ë¥¸ìª½(ê¸°íƒ€ ì·¨ì•½ ì²­ë…„) ë°•ìŠ¤ë§Œ ì„¸ë¡œ ê°€ìš´ë°ë¡œ */
        #slide-yk-3 .yk-box-muted{
        align-self: center;
        }

        .yk-box-title{
        font-size: 24px;
        font-weight: 900;
        color:#111;
        margin: 0 0 10px 0;
        }
        .yk-box-desc{
        font-size: 16px;
        line-height: 1.55;
        color:#333;
        margin: 0;
        word-break: keep-all;
        }

        /* slide-yk-3 grouping (first 3 boxes) */
        .yk-group{
        grid-column: 1 / span 3;
        border: 3px solid #3b82f6;
        border-radius: 12px;
        padding: 18px;
        position: relative;
        background: #f8fbff;
        }
        .yk-group-label{
        position: absolute;
        top: -14px;
        left: 16px;
        background: white;
        padding: 2px 10px;
        font-size: 20px;
        font-weight: 700;
        color: #1e3a8a;
        }
        .yk-group-grid{
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        }
        </style>

</head>
<body>

    <div class="presentation-wrapper">

        <div class="slide-navigator">
            <button id="nav-prev" class="nav-arrow" onclick="navigateSlides(-1)" disabled>&lt;</button>
            <span id="page-indicator"></span>
            <button id="nav-next" class="nav-arrow" onclick="navigateSlides(1)">&gt;</button>
        </div>

        <div id="weekly-trend-slide" class="slide-container">
            <div class="header">
                <div id="weekly-trend-title" class="title">ëŒ€í†µë ¹ ì§ë¬´ ìˆ˜í–‰ í‰ê°€ ì¶”ì´ (ê°¤ëŸ½)</div>
                <div class="subtitle">ê¸°ê°„: 6ì›” 2ì£¼ ~ 12ì›” 2ì£¼ | ìë£Œ: ê°¤ëŸ½/ë¦¬ì–¼ë¯¸í„°</div>
            </div>

            <div id="weekly-trend-controls" class="controls">
                <button class="btn active" data-mode="gallup" onclick="updateWeeklyTrendView('gallup', this)">ê°¤ëŸ½</button>
                <button class="btn" data-mode="realmeter" onclick="updateWeeklyTrendView('realmeter', this)">ë¦¬ì–¼ë¯¸í„°</button>
            </div>

            <div class="chart-wrapper">
                <div class="chart-canvas-box">
                    <canvas id="weeklyTrendChart"></canvas></div>
                <div class="data-source weekly-trend-source"></div>
                </div>

        </div>

        <div id="party-trend-slide" class="slide-container hidden">
            <div class="header">
                <div id="party-trend-title" class="title">ì£¼ìš” ì •ë‹¹ ì§€ì§€ìœ¨ ì¶”ì´ (ê°¤ëŸ½)</div>
                <div class="subtitle">ê¸°ê°„: 8ì›” 2ì£¼ ~ 12ì›” 2ì£¼ | ìë£Œ: ê°¤ëŸ½/ë¦¬ì–¼ë¯¸í„°</div>
            </div>

            <div id="party-trend-controls" class="controls">
                <button class="btn active" data-mode="gallup" onclick="updateWeeklyPartyTrendView('gallup', this)">ê°¤ëŸ½</button>
                <button class="btn" data-mode="realmeter" onclick="updateWeeklyPartyTrendView('realmeter', this)">ë¦¬ì–¼ë¯¸í„°</button>
            </div>

            <div class="chart-wrapper">
            <div class="chart-canvas-box">
                <canvas id="weeklyPartyTrendChart"></canvas>   </div>
            <div class="data-source weekly-trend-source"></div>
            </div>

        </div>
        <div id="pres-slide-full" class="slide-container hidden">
            <div class="header">
                <div class="title">ëŒ€í†µë ¹ ì§ë¬´ ìˆ˜í–‰ í‰ê°€ ì¶”ì´ (ì›”ë³„ í†µí•©)</div>
                <div class="subtitle">ê¸°ê°„: 2025ë…„ 7ì›” ~ 11ì›” | ìë£Œ: í•œêµ­ê°¤ëŸ½</div>
            </div>

            <div class="controls" style="height: 35px;"></div>

            <div class="chart-wrapper">
                <canvas id="presChartFull"></canvas>
            </div>
        </div>

        <div id="party-slide-full" class="slide-container hidden">
            <div class="header">
                <div class="title">ì£¼ìš” ì •ë‹¹ ì§€ì§€ìœ¨ ì¶”ì´ (ì›”ë³„ í†µí•©)</div>
                <div class="subtitle">ê¸°ê°„: 2025ë…„ 7ì›” ~ 11ì›” | ìë£Œ: í•œêµ­ê°¤ëŸ½</div>
            </div>

            <div class="controls" style="height: 35px;"></div>

            <div class="chart-wrapper">
                <canvas id="partyChartFull"></canvas>
            </div>
        </div>

        <div id="pres-slide" class="slide-container hidden">
            <div class="header">
                <div class="title">ëŒ€í†µë ¹ ì§ë¬´ ìˆ˜í–‰ í‰ê°€ ì¶”ì´ (ì›”ë³„í†µí•©, ê¸ì •) - ì„¸ë¶€ ë¹„êµ</div>
                <div class="subtitle">ê¸°ê°„: 2025ë…„ 9ì›” ~ 11ì›” | ìë£Œ: í•œêµ­ê°¤ëŸ½</div>
            </div>

            <div id="pres-controls" class="controls">
                <button class="btn active" data-mode="total" onclick="updatePresView('total', this)">ì „ì²´ ë³´ê¸°</button>
                <button class="btn" data-mode="gender" onclick="updatePresView('gender', this)">ì„±ë³„</button>
                <button class="btn" data-mode="age" onclick="updatePresView('age', this)">ì—°ë ¹ë³„</button>
                <button class="btn" data-mode="region_main" onclick="updatePresView('region_main', this)">ì£¼ìš” ì§€ì—­ë³„</button>
                <button class="btn" data-mode="gender_age_2030" onclick="updatePresView('gender_age_2030', this)">ì„±/ì—°ë ¹ë³„ (2030)</button>
            </div>

            <div class="chart-wrapper">
                <canvas id="presChart"></canvas>
            </div>

        </div>

        <div id="party-slide" class="slide-container hidden">
            <div class="header">
                <div class="title">ì£¼ìš” ì •ë‹¹ ì§€ì§€ìœ¨ ì¶”ì´ (ë¯¼ì£¼ë‹¹, êµ­ë¯¼ì˜í˜, ë¬´ë‹¹ì¸µ) - ì„¸ë¶€</div>
                <div class="subtitle">ê¸°ê°„: 2025ë…„ 9ì›” ~ 11ì›” | ìë£Œ: í•œêµ­ê°¤ëŸ½</div>
            </div>

            <div id="party-controls" class="controls">
                <button class="btn active" disabled>ì „ì²´ ë³´ê¸°</button>
            </div>

            <div class="chart-wrapper">
                <canvas id="partyChart"></canvas>
            </div>
        </div>

        <div id="policy-title-slide" class="slide-container policy-slide hidden" style="justify-content: center; align-items: center;">
            <div style="text-align: center;">
                <h1 class="title-main" style="color: #3b82f6;">ìˆ«ìë¡œ ë³´ëŠ” 'ë³´í˜¸ ì¢…ë£Œ'ì˜ ë¬´ê²Œ: ìë¦½ì¤€ë¹„ì²­ë…„ì˜ ìœ„ê¸° ë¶„ì„</h1>
                <h2 class="title-sub" style="margin-top: 20px;">ì¼ë°˜ ì²­ë…„ê³¼ì˜ ì¬ì •Â·ì‚¬íšŒì  ê²©ì°¨ ì§‘ì¤‘ ë¶„ì„</h2>
            </div>
        </div>

        <div id="slide-yk-1" class="slide-container policy-slide hidden">
        <div class="yk-wrap">
            <div class="yk-titlebar">
            <div class="yk-title">ì‹œì„¤í‡´ì†Œ ìë¦½ì¤€ë¹„ì²­ë…„</div>
            <div></div>
            </div>

            <div class="yk-center">
            <div class="yk-mainword">ìë¦½ì¤€ë¹„ì²­ë…„</div>
            <div class="yk-subcopy">
                ã€Œì•„ë™ë³µì§€ë²•ã€ìƒ ì•„ë™ì–‘ìœ¡ì‹œì„¤Â·ê³µë™ìƒí™œê°€ì •Â·ê°€ì •ìœ„íƒ ë“±ì—ì„œ ë³´í˜¸ë¥¼ ë°›ë‹¤ê°€<br/>
                ë³´í˜¸ì¡°ì¹˜ ì¢…ë£Œ í›„ 5ë…„ ì´ë‚´ì¸ ì²­ë…„
            </div>
            </div>
        </div>
        </div>

        <div id="slide-yk-2" class="slide-container policy-slide hidden">
        <!-- âœ… ì œëª© ì˜ì—­(ìƒë‹¨ ê³ ì •) -->
        <div class="header">
            <div class="title">ì‹œì„¤í‡´ì†Œ ìë¦½ì¤€ë¹„ì²­ë…„</div>
        </div>

        <!-- âœ… ë°•ìŠ¤ ì˜ì—­(ìŠ¬ë¼ì´ë“œ ì •ì¤‘ì•™) -->
        <div class="yk-center">
            <div class="yk-grid">
            <div class="yk-box">
                <div class="yk-box-title">ìë¦½ì¤€ë¹„ì²­ë…„</div>
                <p class="yk-box-desc">ì•„ë™ë³µì§€ë²• ê¸°ë°˜ ë³´í˜¸ì¢…ë£Œ<br>(ì•„ë™ì–‘ìœ¡ì‹œì„¤ ë“±)</p>
            </div>

            <div class="yk-box">
                <div class="yk-box-title">ìë¦½ì¤€ë¹„ì²­ì†Œë…„</div>
                <p class="yk-box-desc">ì²­ì†Œë…„ë³µì§€ì‹œì„¤ í‡´ì†Œ <br>(ì‰¼í„°Â·ìë¦½ì§€ì›ê´€ ë“±)</p>
            </div>

            <div class="yk-box">
                <div class="yk-box-title">ì†Œë…„ë³´í˜¸ì‹œì„¤ ì¶œì›ìƒ</div>
                <p class="yk-box-desc">ì†Œë…„ë²• ì²´ê³„ ë³´í˜¸ì²˜ë¶„ ì¢…ë£Œ<br>(ì†Œë…„ì›, ì†Œë…„ë¶„ë¥˜ì‹¬ì‚¬ì›)</p>
            </div>

            <div class="yk-box yk-box-muted">
                <div class="yk-box-title">ê¸°íƒ€ ì·¨ì•½ ì²­ë…„</div>
                <p class="yk-box-desc">ì‹œì„¤ë³´í˜¸ ê²½í—˜ ì²­ë…„, ë…¸ìˆ™ ì²­ë…„, ê¸°íƒ€ ì·¨ì•½ ì²­ë…„ ë“±</p>
            </div>
            </div>
        </div>
        </div>


        <div id="slide-yk-3" class="slide-container policy-slide hidden">
        <!-- âœ… ì œëª© ì˜ì—­(ìƒë‹¨ ê³ ì •) -->
        <div class="header">
            <div class="title">ì‹œì„¤í‡´ì†Œ ìë¦½ì¤€ë¹„ì²­ë…„</div>
        </div>

        <!-- âœ… ë°•ìŠ¤ ì˜ì—­(ìŠ¬ë¼ì´ë“œ ì •ì¤‘ì•™) -->
        <div class="yk-center">
            <div class="yk-grid">
            <!-- ğŸ”¹ ì•ì˜ 3ê°œë¥¼ ë¬¶ëŠ” ê·¸ë£¹(1~3ì—´ ì°¨ì§€) -->
            <div class="yk-group">
                <div class="yk-group-label">&lt;ì‹œì„¤í‡´ì†Œ ìë¦½ì¤€ë¹„ì²­ë…„&gt;</div>

                <div class="yk-group-grid">
                <div class="yk-box">
                    <div class="yk-box-title">ìë¦½ì¤€ë¹„ì²­ë…„</div>
                    <p class="yk-box-desc">ì•„ë™ë³µì§€ë²• ê¸°ë°˜ ë³´í˜¸ì¢…ë£Œ<br>(ì•„ë™ì–‘ìœ¡ì‹œì„¤ ë“±)</p>
                </div>

                <div class="yk-box">
                <div class="yk-box-title">ìë¦½ì¤€ë¹„ì²­ì†Œë…„</div>
                <p class="yk-box-desc">ì²­ì†Œë…„ë³µì§€ì‹œì„¤ í‡´ì†Œ<br>(ì‰¼í„°Â·ìë¦½ì§€ì›ê´€ ë“±)</p>
                </div>

                <div class="yk-box">
                <div class="yk-box-title">ì†Œë…„ë³´í˜¸ì‹œì„¤ ì¶œì›ìƒ</div>
                <p class="yk-box-desc">ì†Œë…„ë²• ì²´ê³„ ë³´í˜¸ì²˜ë¶„ ì¢…ë£Œ<br>(ì†Œë…„ì›, ì†Œë…„ë¶„ë¥˜ì‹¬ì‚¬ì›)</p>
                </div>
                </div>
            </div>

            <!-- ğŸ”¹ ê°™ì€ ì¤„ì˜ 4ë²ˆì§¸ ë°•ìŠ¤ -->
            <div class="yk-box yk-box-muted">
                <div class="yk-box-title">ê¸°íƒ€ ì·¨ì•½ ì²­ë…„</div>
                <p class="yk-box-desc">ì‹œì„¤ë³´í˜¸ ê²½í—˜ ì²­ë…„, ë…¸ìˆ™ ì²­ë…„, ê¸°íƒ€ ì·¨ì•½ ì²­ë…„ ë“±</p>
            </div>
            </div>
        </div>
        </div>


        <div id="policy-econ-slide" class="slide-container policy-slide hidden">
            <div class="header">
                <div class="title">1. ê²½ì œì  ê¸°ë°˜ì˜ ì·¨ì•½ì„±</div>
                <div class="subtitle">ì›”í‰ê·  ì†Œë“ì€ ì ˆë°˜, í‰ê·  ë¶€ì±„ì•¡ì€ 2.6ë°°</div>
            </div>

            <div class="risk-grid">
                <!-- ì¢Œì¸¡: ì„¸ë¡œë§‰ëŒ€ ì°¨íŠ¸ -->
                <div class="risk-charts">
                <div class="risk-chart-box">
                    <canvas id="chartEcon"></canvas>
                </div>
                </div>

                <!-- ìš°ì¸¡: ìš”ì•½ ì¹´ë“œ(ë¶€ì±„ ë³´ìœ ìœ¨) -->
                <div class="risk-side">
                <div class="risk-card risk-card-red">
                    <h3>ë¶€ì±„ ë³´ìœ ìœ¨</h3>
                    <p class="risk-big">36.4%</p>
                    <p class="risk-sub">(ì¼ë°˜ ì²­ë…„ 16.3%)</p>
                </div>
                </div>
            </div>

            <div class="data-source">ì¶œì²˜ : ë°±í˜œì • ì™¸. (2023). 2023ë…„ ì‹œì„¤í‡´ì†Œì²­ë…„ì˜ ìƒí™œ ì‹¤íƒœ ë° ì •ì±…ê°œë°œ</div>
        </div>

        <div id="policy-negative-exp-slide" class="slide-container policy-slide hidden">
            <div class="header">
                <div class="title">2. ë¶€ì •ì ì¸ ìƒí™œì‚¬ ê²½í—˜</div>
            </div>

            <div class="chart-wrapper">
                <canvas id="chartNegativeExp"></canvas>
            </div>

            <div class="data-source">
                ì¶œì²˜: ê¹€ì§€ì—° ì™¸. (2022). 2022ë…„ ì‹œì„¤í‡´ì†Œì²­ë…„ì˜ ìƒí™œ ì‹¤íƒœ ë° ì •ì±…ê°œë°œ
            </div>
        </div>


        <div id="policy-risk-slide" class="slide-container policy-slide hidden">
            <div class="header">
                <div class="title">3. ì‚¶ì˜ ì§ˆ ì €í•˜ì™€ ê·¹ë‹¨ì ì¸ ìœ„ê¸°</div>
                <div class="subtitle">ìš°ìš¸ ì¦ìƒ ë¹„ìœ¨ 4.1ë°°, ìì‚´ ìƒê° ê²½í—˜ ë¹„ìœ¨ 4.4ë°°</div>
            </div>

            <!-- âœ… 2ì—´ ë ˆì´ì•„ì›ƒ: (ì°¨íŠ¸) + (ìš”ì•½ë°•ìŠ¤) -->
            <div class="risk-grid">
                <!-- ì¢Œì¸¡: í†µí•© ë°”ì°¨íŠ¸ 1ê°œ -->
                <div class="risk-charts">
                <div class="risk-chart-box">
                    <canvas id="chartRisk"></canvas>
                </div>
                </div>

                <!-- ìš°ì¸¡ ìš”ì•½ ì¹´ë“œ -->
                <div class="risk-side">
                    <div class="risk-card risk-card-blue">
                        <h3>ì‚¶ì˜ ë§Œì¡±ë„(10ì  ë§Œì )</h3>
                        <p class="risk-big">4.93ì </p>
                        <p class="risk-sub">(ì¼ë°˜ ì²­ë…„ 6.71ì )</p>
                    </div>
                </div>
            </div>

            <div class="data-source">
                ì¶œì²˜ : ë°±í˜œì • ì™¸. (2023). 2023ë…„ ì‹œì„¤í‡´ì†Œì²­ë…„ì˜ ìƒí™œ ì‹¤íƒœ ë° ì •ì±…ê°œë°œ<br>
                ì´ìƒì • ì™¸. (2024). ìë¦½ì¤€ë¹„ì²­ë…„ ìì‚´ì›ì¸ ë¶„ì„ì„ í†µí•œ íš¨ê³¼ì  ì˜ˆë°©ì²´ê³„ êµ¬ì¶• ì—°êµ¬
            </div>
        </div>

        <div id="policy-welfare-slide" class="slide-container policy-slide hidden">
            <div class="header">
                <div class="title">4. ì •ì±…ì˜ ì‚¬ê°ì§€ëŒ€ : ìë¦½ì§€ì›ìˆ˜ë‹¹</div>
                <div class="subtitle">ì‹œì„¤ ìœ í˜•ë³„ ìë¦½ìˆ˜ë‹¹ ìˆ˜ë ¹ ì—¬ë¶€ (%)</div>
            </div>
            <div class="chart-wrapper" style="height: 720px;">
                <canvas id="chartWelfare"></canvas>
            </div>
            <div class="data-source">ì¶œì²˜: ê¹€ìŠ¹ê²½ ì™¸. (2024). 2024ë…„ ì‹œì„¤í‡´ì†Œì²­ë…„ì˜ ìƒí™œ ì‹¤íƒœ ë° ì •ì±…ê°œë°œ</div>
        </div>

        <div id="policy-solution-slide" class="slide-container policy-slide hidden">
            <div class="header">
                <div class="title">5. ê²©ì°¨ í•´ì†Œë¥¼ ìœ„í•œ ì •ì±… ê³¼ì œ</div>
                <div class="subtitle">ìë¦½ ì„±ê³µì„ ìœ„í•œ ì‹œìŠ¤í…œ ê°•í™” ë°©ì•ˆ (ì „ë¬¸ê°€ ì œì–¸)</div>
            </div>

            <!-- âœ… ë³¸ë¬¸/ì¶œì²˜ë¥¼ ë¶„ë¦¬í•´ì„œ, ì¶œì²˜ë¥¼ ì•„ë˜ë¡œ ê³ ì • -->
            <div class="policy-solution-body">

                <div style="width:100%; margin-top:10px; display:flex; flex-direction:column; gap:10px;">
                <div class="policy-item" style="border-left-color:#3b82f6;">
                    <h3>1. ì§€ì› ì‹œìŠ¤í…œ í†µí•© ë° ì „ë¬¸ ì¸ë ¥ í™•ì¶©</h3>
                    <ul>
                    <li><b>ë¶€ì²˜ ê°„ ì¹¸ë§‰ì´ í•´ì†Œ</b>ë¡œ ì§€ì› ê²½ë¡œë¥¼ ë‹¨ì¼í™”</li>
                    <li>ë³µí•© ë¬¸ì œ(ì£¼ê±°Â·ì·¨ì—…Â·ê±´ê°•) ëŒ€ì‘ì„ ìœ„í•œ <b>ì „ë‹´ ì¸ë ¥</b> í™•ì¶©</li>
                    </ul>
                </div>

                <div class="policy-item" style="border-left-color:#f97316; background:#fff7ed;">
                    <h3>2. í˜„ì‹¤ì ì¸ ê¸ˆìœµ ë°©íŒ¨ ë§ˆë ¨ ë° ê¸°ê°„ í˜„ì‹¤í™”</h3>
                    <ul>
                    <li><b>ìë¦½ ì§€ì› ê¸°ê°„</b>ì„ í˜„ì‹¤ì— ë§ê²Œ ì¡°ì •</li>
                    <li>ê¸ˆìœµì‚¬ê¸° ì˜ˆë°©ì„ ìœ„í•œ <b>ê¸ˆìœµ êµìœ¡ ì˜ë¬´í™”</b> ë° ìƒì‹œ ìƒë‹´</li>
                    </ul>
                </div>

                <div class="policy-item" style="border-left-color:#10b981; background:#f0fdf4;">
                    <h3>3. ì‹¬ë¦¬ ì¹˜ë£Œì™€ ê±´ê°• ê´€ë¦¬ì˜ ì—°ê³„ ê°•í™”</h3>
                    <ul>
                    <li><b>ì •ì‹ ê±´ê°• ì§€ì›</b> í™•ëŒ€(ìš°ìš¸Â·íŠ¸ë¼ìš°ë§ˆ ë“±)</li>
                    <li><b>ì¹˜ë£Œ ì´ë ¥ ë‹¨ì ˆ</b>ì„ ë§‰ëŠ” ì—°ê³„Â·ì¶”ì  ê´€ë¦¬ ì²´ê³„ êµ¬ì¶•</li>
                    </ul>
                </div>
                </div>

                <div class="data-source policy-solution-source">
                ì¶œì²˜ : ë°±í˜œì • ì™¸. (2023). 2023ë…„ ì‹œì„¤í‡´ì†Œì²­ë…„ì˜ ìƒí™œ ì‹¤íƒœ ë° ì •ì±…ê°œë°œ<br>
                ì´ìƒì • ì™¸. (2024). ìë¦½ì¤€ë¹„ì²­ë…„ ìì‚´ì›ì¸ ë¶„ì„ì„ í†µí•œ íš¨ê³¼ì  ì˜ˆë°©ì²´ê³„ êµ¬ì¶• ì—°êµ¬
                </div>

            </div>
        </div>


    </div>

    <script>
        // -----------------------------------------------------------
        // â­ï¸ ì „ì—­ ì„¤ì • ë° ìƒìˆ˜ (ìƒ‰ìƒ í†µì¼ ì ìš©)
        // -----------------------------------------------------------

        // Chart.js ì „ì—­ í°íŠ¸ ì„¤ì • (í•œê¸€ ê¹¨ì§ ë°©ì§€ ë° í°íŠ¸ í†µì¼)
        Chart.defaults.font.family = 'Pretendard, sans-serif';
        Chart.defaults.font.size = 12;

        // â­ï¸ ì‚¬ìš©í•  ìƒ‰ìƒ ì •ì˜ (ì •ì¹˜ ë°ì´í„° vs ìë¦½ì²­ë…„ ë°ì´í„°)
        const POSITIVE_COLOR = '#0056b3'; // ë¯¼ì£¼ë‹¹, ì§ë¬´ ê¸ì • (ì¼ë°˜ ë°ì´í„°: í‘¸ë¥¸ìƒ‰)
        const NEGATIVE_COLOR = '#C9151E'; // êµ­ë¯¼ì˜í˜, ì§ë¬´ ë¶€ì • (ì·¨ì•½ ë°ì´í„°: ë¶‰ì€ìƒ‰)
        const JO_GUK_COLOR = '#4B0082';
        const REFORM_COLOR = '#F38400';
        const PROGRESSIVE_COLOR = '#008000';
        const NON_PARTISAN_COLOR = '#666666'; // ë¬´ë‹¹ì¸µ

        // DataLabels í”ŒëŸ¬ê·¸ì¸ ë“±ë¡
        Chart.register(ChartDataLabels);

        // ì •ì¹˜ ë°ì´í„° ë¼ë²¨
        const labelsFull = ['7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”'];
        const labelsPartial = ['9ì›”', '10ì›”', '11ì›”'];
        
        // í•¨ê»˜ ê³µí‘œÂ·ë³´ë„í•˜ì—¬ì•¼ í•  ì‚¬í•­
        const SOURCE_WEEKLY_GALLUP = `
        * 12ì›” 2ì£¼ ì¡°ì‚¬ : í•œêµ­ê°¤ëŸ½ ìì²´ì¡°ì‚¬ë¡œ 25ë…„ 12ì›” 9ì¼~11ì¼, ë¬´ì„ 100% ì „í™”ë©´ì ‘(CATI)ë¡œ ì§„í–‰í•¨. ê·¸ ë°–ì˜ ì‚¬í•­ì€ ì¤‘ì•™ì„ ê±°ì—¬ë¡ ì¡°ì‚¬ì‹¬ì˜ìœ„ì›íšŒ í™ˆí˜ì´ì§€ ì°¸ì¡°`;
        const SOURCE_WEEKLY_REALMETER = `
        * 12ì›” 2ì£¼ ì¡°ì‚¬ : ì—ë„ˆì§€ê²½ì œì‹ ë¬¸ì˜ë¢°ë¡œ ë¦¬ì–¼ë¯¸í„°ê°€ 25ë…„ 12ì›” 8ì¼~12ì¼, ë¬´ì„ 100% ARSë¡œ ì§„í–‰í•¨. ê·¸ ë°–ì˜ ì‚¬í•­ì€ ì¤‘ì•™ì„ ê±°ì—¬ë¡ ì¡°ì‚¬ì‹¬ì˜ìœ„ì›íšŒ í™ˆí˜ì´ì§€ ì°¸ì¡°`;

        // --- ì°¨íŠ¸ ë°ì´í„° ë° ê°ì²´ ---
        // ì •ì¹˜ ë°ì´í„° ì°¨íŠ¸ ê°ì²´ (ê¸°ì¡´ ìœ ì§€)
        let presChartFull = null;
        let partyChartFull = null;
        let presChart = null;
        let partyChart = null;
        let weeklyTrendChart = null;
        let weeklyTrendData = {};
        let weeklyPartyTrendChart = null;
        let weeklyPartyTrendData = {};

        // ìë¦½ì²­ë…„ ë°ì´í„° ì°¨íŠ¸ ê°ì²´ (ìƒˆë¡œ ì¶”ê°€)
        let chartEcon = null;
        let chartNegativeExp = null;
        let chartWelfare = null;
        let chartRisk = null;

        // â­ï¸ ìŠ¬ë¼ì´ë“œ ìˆœì„œ ë° ìƒíƒœ ê´€ë¦¬
        const slideOrder = [
            'weekly-trend-slide', 'party-trend-slide', 'pres-slide-full', 'party-slide-full', 'pres-slide', 'party-slide', // [1~6] ì •ì¹˜ ë°ì´í„°
            'policy-title-slide', 'slide-yk-1','slide-yk-2','slide-yk-3',    // âœ… [8~10] ìƒˆë¡œ ì¶”ê°€í•œ ê°œë… ìŠ¬ë¼ì´ë“œ
            'policy-econ-slide','policy-negative-exp-slide', 'policy-risk-slide', 'policy-welfare-slide', 'policy-solution-slide' // ìë¦½ì²­ë…„ ë°ì´í„°
        ];
        let currentSlideIndex = 0;
        const pageIndicator = document.getElementById('page-indicator');
        const navPrev = document.getElementById('nav-prev');
        const navNext = document.getElementById('nav-next');
        const pres_controls = document.getElementById('pres-controls');


        // ===========================================================
        // â­ï¸ 1-6 í˜ì´ì§€ (ì •ì¹˜ ë°ì´í„°) ê´€ë ¨ í•¨ìˆ˜ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
        // ===========================================================
 
        function parseCombinedCSV(csvText) {
            const lines = csvText.trim().split('\n');
            const headers = lines[0].split(',');
            const labels = [];
            const gallupData = { good: [], bad: [] };
            const realmeterData = { good: [], bad: [] };

            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                if (values.length === headers.length) {
                    labels.push(values[0].trim());
                    realmeterData.good.push(parseFloat(values[1].trim()));
                    realmeterData.bad.push(parseFloat(values[2].trim()));
                    gallupData.good.push(parseInt(values[4].trim()));
                    gallupData.bad.push(parseInt(values[5].trim()));
                }
            }
            return { labels, gallupData, realmeterData };
        }

        function loadWeeklyTrendChart() {
            const DATA_URL = './data/presidential_approval_real_gal.csv'; 

            fetch(DATA_URL)
                .then(response => response.ok ? response.text() : Promise.reject('ì£¼ê°„ ì§ë¬´ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ' + response.statusText))
                .then(csvText => {
                    weeklyTrendData = parseCombinedCSV(csvText);
                    updateWeeklyTrendView('gallup', document.querySelector('#weekly-trend-controls .btn.active'));
                })
                .catch(error => console.error("ì£¼ê°„ ì§ë¬´ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:", error));
        }

        function updateWeeklySource(mode){
            const isGallup = (mode === 'gallup');
            const html = isGallup ? SOURCE_WEEKLY_GALLUP : SOURCE_WEEKLY_REALMETER;

            // í˜„ì¬ ë¬¸ì„œì— ìˆëŠ” ë™ì¼ ì¶œì²˜ ì˜ì—­ì„ ëª¨ë‘ ê°±ì‹  (1ìª½/2ìª½ ë™ì‹œì— í•´ê²°)
            document.querySelectorAll('.weekly-trend-source').forEach(el => {
                el.innerHTML = html;
            });
        }

        function updateWeeklyTrendView(mode, btnElement) {
            if (!weeklyTrendData.labels) return; 

            document.querySelectorAll('#weekly-trend-controls .btn').forEach(btn => btn.classList.remove('active'));
            if (btnElement) {
                btnElement.classList.add('active');
            }

            const isGallup = mode === 'gallup';
            currentWeeklyTrendMode = mode;   // â­ï¸ í˜„ì¬ 1í˜ì´ì§€ ëª¨ë“œ ì €ì¥
            updateWeeklySource(mode); 
            const source = isGallup ? weeklyTrendData.gallupData : weeklyTrendData.realmeterData;

            document.getElementById('weekly-trend-title').textContent = `ëŒ€í†µë ¹ ì§ë¬´ ìˆ˜í–‰ í‰ê°€ ì¶”ì´ (${isGallup ? 'ê°¤ëŸ½' : 'ë¦¬ì–¼ë¯¸í„°'})`;

            const newDatasets = [
                { label: 'ê¸ì •', data: source.good, borderColor: POSITIVE_COLOR, backgroundColor: POSITIVE_COLOR, borderWidth: 3, pointRadius: 5, pointHoverRadius: 7, tension: 0, order: 1 },
                { label: 'ë¶€ì •', data: source.bad, borderColor: NEGATIVE_COLOR, backgroundColor: NEGATIVE_COLOR, borderWidth: 3, pointRadius: 5, pointHoverRadius: 7, tension: 0, order: 2 }
            ];

            if (!weeklyTrendChart) {
                weeklyTrendChart = initChart('weeklyTrendChart', weeklyTrendData.labels, newDatasets, 0, 80);
            } else {
                weeklyTrendChart.data.labels = weeklyTrendData.labels;
                weeklyTrendChart.data.datasets = newDatasets;
                weeklyTrendChart.update();
            }
        }

        // ===========================================================
        // â­ï¸ 2í˜ì´ì§€: ì •ë‹¹ ì§€ì§€ìœ¨ ì£¼ê°„ ë¡œì§ (ìƒˆë¡œ ì¶”ê°€ë¨)
        // ===========================================================

        function parsePartyCSV(csvText, isGallup) {
            const lines = csvText.trim().split('\n');
            if (lines.length < 2) {
                return {
                    labels: [],
                    partyData: {
                        'ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹': [],
                        'êµ­ë¯¼ì˜í˜': [],
                        'ì¡°êµ­í˜ì‹ ë‹¹': [],
                        'ê°œí˜ì‹ ë‹¹': [],
                        'ì§„ë³´ë‹¹': [],
                        'ë¬´ë‹¹ì¸µ': []
                    }
                };
            }
        
            // â‘  í—¤ë” í–‰ íŒŒì‹±
            const headers = lines[0].split(',').map(h => h.trim());
        
            // week / ì •ë‹¹ë³„ ì»¬ëŸ¼ ì¸ë±ìŠ¤ë¥¼ í—¤ë” ì´ë¦„ìœ¼ë¡œ ì°¾ê¸°
            const idxWeek   = headers.indexOf('week');
            const idxDem    = headers.indexOf('ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹');
            const idxCon    = headers.indexOf('êµ­ë¯¼ì˜í˜');
            const idxCho    = headers.indexOf('ì¡°êµ­í˜ì‹ ë‹¹');
            const idxReform = headers.indexOf('ê°œí˜ì‹ ë‹¹');
            const idxProg   = headers.indexOf('ì§„ë³´ë‹¹');
            const idxNone   = headers.indexOf('ë¬´ë‹¹ì¸µ');
        
            const labels = [];
            const data = {
                'ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹': [],
                'êµ­ë¯¼ì˜í˜': [],
                'ì¡°êµ­í˜ì‹ ë‹¹': [],
                'ê°œí˜ì‹ ë‹¹': [],
                'ì§„ë³´ë‹¹': [],
                'ë¬´ë‹¹ì¸µ': []
            };
        
            // â‘¡ ì‹¤ì œ ë°ì´í„° í–‰ íŒŒì‹±
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;    // ë¹ˆ ì¤„ ê±´ë„ˆë›°ê¸°
        
                const values = line.split(',').map(v => v.trim());
        
                // ë¼ë²¨(week)
                if (idxWeek >= 0) {
                    labels.push(values[idxWeek]);
                } else {
                    labels.push('');    // í˜¹ì‹œë¼ë„ week í—¤ë”ë¥¼ ëª» ì°¾ìœ¼ë©´ ë¹ˆ ë¬¸ìì—´
                }
        
                // ê°’ íŒŒì‹± í•¨ìˆ˜: ê°¤ëŸ½ì€ ì •ìˆ˜, ë¦¬ì–¼ë¯¸í„°ëŠ” ì†Œìˆ˜(ë‘˜ ë‹¤ parseFloat ì¨ë„ í° ë¬¸ì œëŠ” ì—†ìŒ)
                const parseVal = v => {
                    if (v === '' || v == null) return null;  // ê²°ì¸¡ì€ null
                    return isGallup ? parseInt(v) : parseFloat(v);
                };
                
                if (idxDem    >= 0) data['ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹'].push(parseVal(values[idxDem]));
                if (idxCon    >= 0) data['êµ­ë¯¼ì˜í˜'].push(parseVal(values[idxCon]));
                if (idxCho    >= 0) data['ì¡°êµ­í˜ì‹ ë‹¹'].push(parseVal(values[idxCho]));
                if (idxReform >= 0) data['ê°œí˜ì‹ ë‹¹'].push(parseVal(values[idxReform]));
                if (idxProg   >= 0) data['ì§„ë³´ë‹¹'].push(parseVal(values[idxProg]));
                if (idxNone   >= 0) data['ë¬´ë‹¹ì¸µ'].push(parseVal(values[idxNone]));
            }
        
            // ë””ë²„ê¹…ìš©ìœ¼ë¡œ ì²« ëª‡ ê°œë§Œ ì°ì–´ì„œ í™•ì¸í•´ë³¼ ìˆ˜ë„ ìˆì–´ìš”.
            console.log("parsePartyCSV labels (first 5):", labels.slice(0, 5));
            console.log("parsePartyCSV ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹ (first 5):", data['ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹'].slice(0, 5));
        
            return { labels, partyData: data };
        }

        
        // â­ï¸ CSV ë°ì´í„° ë¡œë“œ
        function loadWeeklyPartyTrendChart() {
            console.log("2í˜ì´ì§€ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜ ì‹œì‘.");
            const GALLUP_URL = './data/party_approval_gal_week.csv';
            const REALMETER_URL = './data/party_approval_real_week.csv';
            
            // ê°¤ëŸ½ ë°ì´í„° ë¡œë“œ
            const fetchGallup = fetch(GALLUP_URL)
                .then(response => response.ok ? response.text() : Promise.reject('ê°¤ëŸ½ ì •ë‹¹ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ' + response.statusText))
                .then(csvText => parsePartyCSV(csvText, true));

            // ë¦¬ì–¼ë¯¸í„° ë°ì´í„° ë¡œë“œ
            const fetchRealmeter = fetch(REALMETER_URL)
                .then(response => response.ok ? response.text() : Promise.reject('ë¦¬ì–¼ë¯¸í„° ì •ë‹¹ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ' + response.statusText))
                .then(csvText => parsePartyCSV(csvText, false));

            Promise.all([fetchGallup, fetchRealmeter])
                .then(([gallupResult, realmeterResult]) => {
                    weeklyPartyTrendData = {
                        gallup: gallupResult,
                        realmeter: realmeterResult
                    };
                    // ì´ˆê¸° ì°¨íŠ¸ (ê°¤ëŸ½) ë Œë”ë§
                    updateWeeklyPartyTrendView('gallup', document.querySelector('#party-trend-controls .btn.active'));
                })
                .catch(error => console.error("ì£¼ê°„ ì •ë‹¹ ì§€ì§€ìœ¨ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:", error));
        }

        // â­ï¸ ì°¨íŠ¸ ë·° ì—…ë°ì´íŠ¸
        function updateWeeklyPartyTrendView(mode, btnElement) {
            if (!weeklyPartyTrendData.gallup) return;

            document.querySelectorAll('#party-trend-controls .btn').forEach(btn => btn.classList.remove('active'));
            if (btnElement) {
                btnElement.classList.add('active');
            }

            const isGallup = mode === 'gallup';
            currentWeeklyPartyMode = mode;   // â­ï¸ í˜„ì¬ ëª¨ë“œë¥¼ ì „ì—­ì— ì €ì¥
            updateWeeklySource(mode);  
            const source = isGallup ? weeklyPartyTrendData.gallup : weeklyPartyTrendData.realmeter;
            
            document.getElementById('party-trend-title').textContent = `ì£¼ìš” ì •ë‹¹ ì§€ì§€ìœ¨ ì¶”ì´ (${isGallup ? 'ê°¤ëŸ½' : 'ë¦¬ì–¼ë¯¸í„°'})`;

            const partyColors = {
                'ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹': POSITIVE_COLOR,
                'êµ­ë¯¼ì˜í˜': NEGATIVE_COLOR,
                'ì¡°êµ­í˜ì‹ ë‹¹': JO_GUK_COLOR,
                'ê°œí˜ì‹ ë‹¹': REFORM_COLOR,
                'ì§„ë³´ë‹¹': PROGRESSIVE_COLOR,
                'ë¬´ë‹¹ì¸µ': NON_PARTISAN_COLOR
            };
            
            // ì •ë‹¹ë³„ ë°ì´í„°ì…‹ ìƒì„± (ìˆœì„œ ì§€ì •)
            const newDatasets = [
                { label: 'ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹', data: source.partyData['ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹'], borderColor: partyColors['ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹'], borderWidth: 3, pointRadius: 5, pointHoverRadius: 7, tension: 0, order: 1 },
                { label: 'êµ­ë¯¼ì˜í˜', data: source.partyData['êµ­ë¯¼ì˜í˜'], borderColor: partyColors['êµ­ë¯¼ì˜í˜'], borderWidth: 3, pointRadius: 5, pointHoverRadius: 7, tension: 0, order: 2 },
                { label: 'ë¬´ë‹¹ì¸µ', data: source.partyData['ë¬´ë‹¹ì¸µ'], borderColor: partyColors['ë¬´ë‹¹ì¸µ'], borderWidth: 2, borderDash: [5, 5], pointRadius: 4, pointHoverRadius: 6, tension: 0, order: 6 },
                { label: 'ì¡°êµ­í˜ì‹ ë‹¹', data: source.partyData['ì¡°êµ­í˜ì‹ ë‹¹'], borderColor: partyColors['ì¡°êµ­í˜ì‹ ë‹¹'], borderWidth: 2, pointRadius: 4, pointHoverRadius: 6, tension: 0, order: 3 },
                { label: 'ê°œí˜ì‹ ë‹¹', data: source.partyData['ê°œí˜ì‹ ë‹¹'], borderColor: partyColors['ê°œí˜ì‹ ë‹¹'], borderWidth: 2, pointRadius: 4, pointHoverRadius: 6, tension: 0, order: 4 },
                { label: 'ì§„ë³´ë‹¹', data: source.partyData['ì§„ë³´ë‹¹'], borderColor: partyColors['ì§„ë³´ë‹¹'], borderWidth: 2, pointRadius: 4, pointHoverRadius: 6, tension: 0, order: 5 }
            ];

            if (!weeklyPartyTrendChart) {
                // âœ… useLabels=true (ë˜ëŠ” ìƒëµ) ë¡œ ë³€ê²½
                weeklyPartyTrendChart = initChart('weeklyPartyTrendChart', source.labels, newDatasets, 0, 50, true); 
            } else {
                weeklyPartyTrendChart.data.labels = source.labels;
                weeklyPartyTrendChart.data.datasets = newDatasets;
                weeklyPartyTrendChart.update();
            }
        }


        // ===========================================================
        // ì¬ì‚¬ìš© í•¨ìˆ˜ë“¤ (initChart, ì›”ê°„ ë°ì´í„° ë“±)
        // ===========================================================
        
        // [2í˜ì´ì§€: ì§ë¬´ í‰ê°€ ì „ì²´ ë°ì´í„° - ê¸ì •/ë¶€ì •]
        const pres_data_Full = [
            { label: 'ê¸ì • í‰ê°€', data: [64, 58, 59, 56, 60], borderColor: POSITIVE_COLOR, backgroundColor: POSITIVE_COLOR, borderWidth: 3, pointRadius: 6, pointHoverRadius: 8, tension: 0, order: 1 },
            { label: 'ë¶€ì • í‰ê°€', data: [23, 32, 32, 34, 30], borderColor: NEGATIVE_COLOR, backgroundColor: NEGATIVE_COLOR, borderWidth: 3, pointRadius: 6, pointHoverRadius: 8, tension: 0, order: 2 }
        ];

        // [3í˜ì´ì§€: ì •ë‹¹ ì§€ì§€ìœ¨ ë°ì´í„° - 7ì›” í¬í•¨]
        const partyData_Full = [
            { label: 'ë¯¼ì£¼ë‹¹', data: [45, 43, 40, 41, 42], borderColor: POSITIVE_COLOR, borderWidth: 3, pointRadius: 5, pointHoverRadius: 7, tension: 0, order: 1 }, 
            { label: 'êµ­ë¯¼ì˜í˜', data: [20, 23, 24, 25, 25], borderColor: NEGATIVE_COLOR, borderWidth: 3, pointRadius: 5, pointHoverRadius: 7, tension: 0, order: 2 }, 
            { label: 'ë¬´ë‹¹ì¸µ', data: [25, 25, 27, 26, 26], borderColor: NON_PARTISAN_COLOR, borderWidth: 2, borderDash: [5, 5], pointRadius: 4, pointHoverRadius: 6, tension: 0, order: 3 } 
        ];

        // 4, 5, 6í˜ì´ì§€ì— ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ì…‹ (ìƒëµ)
        const pres_totalData_Partial = { label: 'ì§ë¬´ í‰ê°€ ì „ì²´', data: [59, 56, 60], borderColor: '#000000', backgroundColor: '#000000', borderWidth: 2, pointRadius: 5, pointHoverRadius: 7, tension: 0, order: 1 };
        const pres_categories_Partial = { /* ... ë°ì´í„°ì…‹ ì •ì˜ ìœ ì§€ ... */ 
            'total': [],
            'gender': [
                { label: 'ë‚¨ì„±', data: [56, 56, 60], borderColor: '#36A2EB', borderWidth: 2 },
                { label: 'ì—¬ì„±', data: [62, 56, 61], borderColor: '#FF6384', borderWidth: 2 }
            ],
            'age': [
                { label: '18~29ì„¸', data: [43, 41, 51], borderColor: '#4BC0C0', borderWidth: 2 },
                { label: '30ëŒ€', data: [62, 51, 57], borderColor: '#FF9F40', borderWidth: 2 },
                { label: '40ëŒ€', data: [75, 74, 76], borderColor: '#9966FF', borderWidth: 2 },
                { label: '50ëŒ€', data: [71, 70, 72], borderColor: '#FFCD56', borderWidth: 2 },
                { label: '60ëŒ€', data: [53, 47, 55], borderColor: '#C9CBCF', borderWidth: 2 },
                { label: '70ëŒ€ ì´ìƒ', data: [44, 46, 47], borderColor: '#8c8c8c', borderWidth: 2, borderDash: [5, 5] }
            ],
            'region_main': [
                { label: 'ì„œìš¸', data: [60, 50, 61], borderColor: '#E91E63', borderWidth: 3 },
                { label: 'ì¸ì²œ/ê²½ê¸°', data: [61, 58, 60], borderColor: '#3F51B5', borderWidth: 2 },
                { label: 'ëŒ€êµ¬/ê²½ë¶', data: [41, 40, 45], borderColor: '#009688', borderWidth: 2 },
                { label: 'ë¶€ì‚°/ìš¸ì‚°/ê²½ë‚¨', data: [51, 52, 56], borderColor: '#795548', borderWidth: 2 },
                { label: 'ê´‘ì£¼/ì „ë¼', data: [84, 80, 85], borderColor: '#4CAF50', borderWidth: 2, borderDash: [5, 5] }
            ],
            'gender_age_2030': [
                { label: 'ë‚¨ì„± 20ëŒ€', data: [30, 32, 45], borderColor: '#2980b9', borderWidth: 2, borderDash: [5, 2] },
                { label: 'ì—¬ì„± 20ëŒ€', data: [57, 52, 58], borderColor: '#e74c3c', borderWidth: 2, borderDash: [5, 2] },
                { label: 'ë‚¨ì„± 30ëŒ€', data: [52, 48, 52], borderColor: '#3498db', borderWidth: 2 },
                { label: 'ì—¬ì„± 30ëŒ€', data: [74, 55, 63], borderColor: '#e67e22', borderWidth: 2 }
            ]
        };
        const partyData_Partial = [
            { label: 'ë¯¼ì£¼ë‹¹', data: [40, 41, 42], borderColor: POSITIVE_COLOR, borderWidth: 3, pointRadius: 5, pointHoverRadius: 7, tension: 0, order: 1 },
            { label: 'êµ­ë¯¼ì˜í˜', data: [24, 25, 25], borderColor: NEGATIVE_COLOR, borderWidth: 3, pointRadius: 5, pointHoverRadius: 7, tension: 0, order: 2 },
            { label: 'ë¬´ë‹¹ì¸µ', data: [27, 26, 26], borderColor: NON_PARTISAN_COLOR, borderWidth: 2, borderDash: [5, 5], pointRadius: 4, pointHoverRadius: 6, tension: 0, order: 3 }
        ];

        // -----------------------------------------------------------
        // â­ï¸ 7-11 í˜ì´ì§€ (ìë¦½ì¤€ë¹„ì²­ë…„ ë°ì´í„°) ê´€ë ¨ í•¨ìˆ˜ (ìƒˆë¡œ ì¶”ê°€)
        // -----------------------------------------------------------

        function createBarChart(canvasId, labels, datasets, yMin, yMax, unit) {
          const ctx = document.getElementById(canvasId).getContext('2d');
          const isHorizontal = (canvasId === 'chartEcon');
        
          return new Chart(ctx, {
            type: 'bar',
            data: { labels, datasets },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              indexAxis: isHorizontal ? 'y' : 'x',
              layout: { padding: { left: 10, right: 20, top: 10, bottom: 10 } },
              plugins: {
                legend: { position: 'bottom', labels: { usePointStyle: true, boxWidth: 10, padding: 15 } },
                tooltip: {
                  callbacks: {
                    label: function(context) {
                      const v = isHorizontal ? context.parsed.x : context.parsed.y;
                      return `${context.dataset.label}: ${v}${unit}`;
                    }
                  }
                },
                datalabels: {
                  display: true,
                  color: '#333',
                  anchor: 'end',
                  align: 'end',
                  formatter: (value) => `${value}${unit}`
                }
              },
              scales: isHorizontal
                ? {
                    x: { min: 0, max: yMax, grid: { color: '#e0e0e0' }, ticks: { font: { size: 11 } } },
                    y: { grid: { display: false }, ticks: { font: { size: 11 } } }
                  }
                : {
                    x: { grid: { color: '#e0e0e0' }, ticks: { font: { size: 11 } } },
                    y: { min: yMin, max: yMax, grid: { color: '#e0e0e0', drawBorder: false }, ticks: { font: { size: 11 } } }
                  }
            },
            plugins: [ChartDataLabels]
          });
        }

        function createWelfareChart() {
            const labels = ['ì‹œì„¤ í‡´ì†Œ ì²­ë…„\nì „ì²´', 'ì•„ë™ì‹œì„¤', 'ì²­ì†Œë…„ì‹œì„¤', 'ì†Œë…„ë³´í˜¸ì‹œì„¤'];

            const data_current = [56.3, 68.0, 23.3, 17.1];  // í˜„ì¬ ë°›ê³  ìˆë‹¤
            const data_past    = [22.1, 25.1, 13.5, 11.4];  // ê³¼ê±°ì—ëŠ” ë°›ì•˜ìœ¼ë‚˜ í˜„ì¬ëŠ” ë°›ì§€ ì•ŠëŠ”ë‹¤
            const data_never   = [21.6,  6.9, 63.2, 71.5];  // í•œ ë²ˆë„ ë°›ì€ ì  ì—†ë‹¤

            const ctx = document.getElementById('chartWelfare').getContext('2d');

            return new Chart(ctx, {
                type: 'bar',
                data: {
                labels,
                datasets: [
                    { label: 'í˜„ì¬ ë°›ê³  ìˆë‹¤', data: data_current, stack: 'stack1',backgroundColor: '#5b7bbf',categoryPercentage: 0.7,
    barPercentage: 0.8 },
                    { label: 'ê³¼ê±°ì—” ë°›ì•˜ìœ¼ë‚˜ í˜„ì¬ëŠ” ë°›ì§€ ì•ŠëŠ”ë‹¤', data: data_past, stack: 'stack1',backgroundColor: '#d6a55f',categoryPercentage: 0.7,
    barPercentage: 0.8 },
                    { label: 'í•œ ë²ˆë„ ë°›ì€ ì  ì—†ë‹¤', data: data_never, stack: 'stack1',backgroundColor: '#c97a7a',categoryPercentage: 0.7,
    barPercentage: 0.8 }
                ]
                },
                options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',                 // âœ… ê°€ë¡œ ëˆ„ì ë§‰ëŒ€(ê°€ë…ì„± ì¢‹ìŒ)
                scales: {
                    x: {
                    stacked: true,
                    min: 0,
                    max: 100,
                    ticks: { callback: (v) => v + '%' }
                    },
                    y: { stacked: true,
                        ticks: {
                        padding: 12,
                        font: { size: 14, weight: '600' }
                        } }
                },
                plugins: {
                    legend: { position: 'right',
                              align: 'center',
                              labels: {boxWidth: 14,boxHeight: 14,padding: 12,
                                    font: {size: 13,weight: '600'},
                                    color: '#333'}},
                    tooltip: {
                    callbacks: {
                        label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.x}%`
                    }
                    },
                    datalabels: {color: '#ffffff',font: {weight: '700', size: 12},    
                    formatter: (v) => (v >= 8 ? v + '%' : ''),  // âœ… ë„ˆë¬´ ì‘ì€ ì¡°ê°ì€ ìˆ¨ê¹€(ì›í•˜ë©´ ìˆ«ì ì¡°ì •)
                    anchor: 'center',
                    align: 'center',clamp: true 
                    }
                },
                layout: {
                padding: {
                    left: 20,
                    right: 20,
                    top: 20,
                    bottom: 20
                }
                }
                }
            });
        }


        // 7. ê²½ì œì  ìƒí™© ì°¨íŠ¸
        function createEconChart() {
        // âœ… ì°¨íŠ¸ì—ëŠ” 2ê°œë§Œ ë‚¨ê¹€
        const labels = ['ì›”í‰ê·  ì†Œë“(ë§Œì›)', 'í‰ê·  ë¶€ì±„ì•¡(ë§Œì›)'];

        const datasets = [
            {
            label: 'ì¼ë°˜ ì²­ë…„(19~29ì„¸)',
            data: [365, 514],
            backgroundColor: '#60a5fa',   // âœ… 9ìª½ê³¼ ë™ì¼í•œ íŒŒë‘ í†¤
            borderRadius: 4
            },
            {
            label: 'ì‹œì„¤ í‡´ì†Œ ì²­ë…„',
            data: [170, 1366],
            backgroundColor: '#dc2626',   // âœ… 9ìª½ê³¼ ë™ì¼í•œ ë¹¨ê°• í†¤
            borderRadius: 4
            }
        ];

        const ctx = document.getElementById('chartEcon').getContext('2d');

        return new Chart(ctx, {
            type: 'bar',
            data: { labels, datasets },
            options: {
            responsive: true,
            maintainAspectRatio: false,
            // âœ… ì„¸ë¡œë§‰ëŒ€: indexAxis ì œê±°(ë˜ëŠ” 'x')
            layout: { padding: { left: 10, right: 20, top: 10, bottom: 10 } },
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: { usePointStyle: true, boxWidth: 10, padding: 15 }
                    },
                tooltip: {
                callbacks: {
                    label: (context) => `${context.dataset.label}: ${context.raw.toLocaleString()}ë§Œì›`
                }
                },
                datalabels: {
                display: true,
                color: '#333',
                anchor: 'end',
                align: 'end',
                formatter: (value) => `${value.toLocaleString()}ë§Œì›`
                }
            },
            scales: {
                y: {
                beginAtZero: true,
                suggestedMax: 1500,  // ë¶€ì±„ì•¡ ìµœëŒ€ê°’ ë°˜ì˜
                grid: { color: '#e0e0e0', drawBorder: false },
                ticks: { font: { size: 11 } }
                },
                x: {
                grid: { display: false },
                ticks: { font: { size: 16 } }
                }
            }
            },
            plugins: [ChartDataLabels]
        });
        }

        
        function createNegativeExpChart() {
            const labels = [
                'ê°€ì •í˜•í¸ì´ ê¸‰ê²©íˆ\nì–´ë ¤ì›Œì§„ ê²½í—˜',
                'ê²½ì œì  ë¬¸ì œë¡œ\ní•™ì—… ì¤‘ë‹¨Â·íœ´í•™ ê²½í—˜',
                'ì•„ëŠ” ì‚¬ëŒì—ê²Œ\në°°ì‹ Â·ì‚¬ê¸° í”¼í•´',
                'ëª¨ë¥´ëŠ” ì‚¬ëŒì—ê²Œ\nì‚¬ê¸°Â·í­ë ¥ í”¼í•´'
            ];

            const datasets = [
                {
                label: 'ì¼ë°˜ ì²­ë…„ (19~29ì„¸)',
                data: [17.8, 4.7, 7.2, null],      // â— ë¬¸í•­ ë¯¸ì¡°ì‚¬ â†’ null
                backgroundColor: '#60a5fa',
                borderRadius: 4
                },
                {
                label: 'ì‹œì„¤ í‡´ì†Œ ì²­ë…„',
                data: [51.1, 14.2, 26.7, 14.9],
                backgroundColor: '#dc2626',
                borderRadius: 4
                }
            ];

            const ctx = document.getElementById('chartNegativeExp').getEncodes
                ? null
                : document.getElementById('chartNegativeExp').getContext('2d');

            return new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets },
                options: {
                responsive: true,
                maintainAspectRatio: false,

                // âœ… Risk ì°¨íŠ¸ì™€ ë™ì¼
                layout: { padding: { left: 10, right: 20, top: 10, bottom: 10 } },

                plugins: {
                    // âœ… Risk ì°¨íŠ¸ì™€ ë™ì¼
                    legend: {
                    position: 'bottom',
                    labels: { usePointStyle: true, boxWidth: 10, padding: 15 }
                    },
                    tooltip: {
                    callbacks: {
                        // nullì´ë©´ â€œí•´ë‹¹ ë¬¸í•­ ì—†ìŒâ€ìœ¼ë¡œ í‘œì‹œ (ì¼ê´€ì„± í•´ì¹˜ì§€ ì•Šê²Œ tooltipë§Œ ì²˜ë¦¬)
                        label: (context) => {
                        if (context.raw === null) return `${context.dataset.label}: í•´ë‹¹ ë¬¸í•­ ì—†ìŒ`;
                        return `${context.dataset.label}: ${context.parsed.y}%`;
                        }
                    }
                    },
                    datalabels: {
                    display: true,
                    color: '#333',
                    anchor: 'end',
                    align: 'end',
                    formatter: (v) => (v === null ? '' : `${v}%`)
                    }
                },

                scales: {
                    // âœ… yì¶•ì€ ë°ì´í„° ë²”ìœ„ ê³ ë ¤(ìµœëŒ€ 30ëŒ€)í•˜ë˜ Risk ì°¨íŠ¸ í†¤ ìœ ì§€
                    y: {
                    min: 0,
                    max: 55,              
                    ticks: { stepSize: 10 },
                    grid: { color: '#e0e0e0' }
                    },
                    x: {
                    grid: { display: false },
                    ticks: { font: { size: 16 } }
                    }
                },

                // âœ… ë§‰ëŒ€ â€œë‘ê»˜/ê°„ê²©â€ì„ Risk ì°¨íŠ¸ì™€ ë¹„ìŠ·í•œ ì²´ê°ìœ¼ë¡œ ê³ ì •
                datasets: {
                    bar: {
                    categoryPercentage: 0.5, // ì¹´í…Œê³ ë¦¬ ë‚´ ë§‰ëŒ€ê°€ ì°¨ì§€í•˜ëŠ” í­
                    barPercentage: 0.9       // ì‹¤ì œ ë§‰ëŒ€ í­
                    }
                }
                },
                plugins: [ChartDataLabels]
            });
        }

        // 8. ì‹¬ë¦¬ì  ìœ„ê¸° ì°¨íŠ¸ (ìì‚´ ìƒê° ê²½í—˜)
        function createRiskCombinedChart() {
            const labels = ['ìì‚´ ìƒê° ê²½í—˜ ë¹„ìœ¨', 'ìš°ìš¸ ì¦ìƒ ê²½í—˜ ë¹„ìœ¨'];

            const datasets = [
                {
                label: 'ì¼ë°˜ ì²­ë…„ (19~29ì„¸)',
                data: [10.5, 5.9],
                backgroundColor: '#60a5fa',
                borderRadius: 4
                },
                {
                label: 'ì‹œì„¤ í‡´ì†Œ ì²­ë…„',
                data: [46.5, 24.5],
                backgroundColor: '#dc2626',
                borderRadius: 4
                }
            ];

            const ctx = document.getElementById('chartRisk').getEncodes ? null : document.getElementById('chartRisk').getContext('2d');

            return new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets },
                options: {
                responsive: true,
                maintainAspectRatio: false,
                layout: { padding: { left: 10, right: 20, top: 10, bottom: 10 } },
                plugins: {
                    legend: { position: 'bottom', labels: { usePointStyle: true, boxWidth: 10, padding: 15 } },
                    tooltip: {
                    callbacks: {
                        label: (context) => `${context.dataset.label}: ${context.parsed.y}%`
                    }
                    },
                    datalabels: {
                    display: true,
                    color: '#333',
                    anchor: 'end',
                    align: 'end',
                    formatter: (v) => `${v}%`
                    }
                },
                scales: {
                    y: { min: 0, max: 60, ticks: { stepSize: 10 }, grid: { color: '#e0e0e0' } },
                    x: { grid: { display: false }, ticks: { font: { size: 16 } } }
                }
                },
                plugins: [ChartDataLabels]
            });
        }

        // â­ï¸ ì°¨íŠ¸ ì´ˆê¸°í™” í•¨ìˆ˜ (DataLabels í™œì„±í™” ì—¬ë¶€ ì¸ì ì¶”ê°€: useLabels)
        function initChart(canvasId, labels, initialDatasets, yMin, yMax, useLabels = true) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            
            // âœ… DataLabels ì ìš© ëŒ€ìƒì— weeklyPartyTrendChart ì¶”ê°€
            const useDataLabels = useLabels && (
                canvasId === 'weeklyTrendChart' || 
                canvasId === 'presChartFull' || 
                canvasId === 'partyChartFull' ||
                canvasId === 'weeklyPartyTrendChart'
            );
            
            const plugins = {
                legend: { 
                    position: 'right', 
                    align: 'start', 
                    labels: { 
                        usePointStyle: true, 
                        boxWidth: 8, 
                        padding: 15 
                    } 
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let value = context.parsed.y;
            
                            // âœ… 1í˜ì´ì§€: ì§ë¬´ ì£¼ê°„ ì°¨íŠ¸
                            if (canvasId === 'weeklyTrendChart') {
                                if (currentWeeklyTrendMode === 'realmeter') {
                                    // ë¦¬ì–¼ë¯¸í„°: í•­ìƒ ì†Œìˆ˜ 1ìë¦¬
                                    value = value.toFixed(1);
                                } else {
                                    // ê°¤ëŸ½: ì •ìˆ˜ë©´ ì •ìˆ˜, ì•„ë‹ˆë©´ ì†Œìˆ˜ 1ìë¦¬
                                    value = Number.isInteger(value) ? value.toString() : value.toFixed(1);
                                }
                            }
                            // âœ… 2í˜ì´ì§€: ì •ë‹¹ ì£¼ê°„ ì°¨íŠ¸
                            else if (canvasId === 'weeklyPartyTrendChart') {
                                if (currentWeeklyPartyMode === 'realmeter') {
                                    value = value.toFixed(1);
                                } else {
                                    value = Number.isInteger(value) ? value.toString() : value.toFixed(1);
                                }
                            }
                            // âœ… ê·¸ ì™¸ ì°¨íŠ¸ë“¤
                            else {
                                value = Number.isInteger(value) ? value.toString() : value.toFixed(1);
                            }
            
                            return context.dataset.label + ': ' + value + '%';
                        }
                    }
                }
            };
            
            if (useDataLabels) {
                plugins.datalabels = {
                    display: function(context) {
                        const label = context.dataset.label;
            
                        // 1í˜ì´ì§€: ì§ë¬´ ì£¼ê°„ (ê¸ì •/ë¶€ì •ë§Œ)
                        if (canvasId === 'weeklyTrendChart') {
                            return label === 'ê¸ì •' || label === 'ë¶€ì •';
                        }
            
                        // 3í˜ì´ì§€: ì§ë¬´ ì›”ê°„ (ê¸ì • í‰ê°€/ë¶€ì • í‰ê°€ë§Œ)
                        if (canvasId === 'presChartFull') {
                            return label === 'ê¸ì • í‰ê°€' || label === 'ë¶€ì • í‰ê°€';
                        }
            
                        // 3í˜ì´ì§€: ì •ë‹¹ ì›”ê°„ (ë¯¼ì£¼ë‹¹/êµ­ë¯¼ì˜í˜/ë¬´ë‹¹ì¸µë§Œ)
                        if (canvasId === 'partyChartFull') {
                            // â­ ì—¬ê¸°ì„œ 'ë¯¼ì£¼ë‹¹' ê³¼ 'ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹' ë‘˜ ë‹¤ ì¸ì •
                            return ['ë¯¼ì£¼ë‹¹', 'ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹', 'êµ­ë¯¼ì˜í˜', 'ë¬´ë‹¹ì¸µ'].includes(label);
                        }
            
                        // 2í˜ì´ì§€: ì •ë‹¹ ì£¼ê°„ (ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹/êµ­ë¯¼ì˜í˜/ë¬´ë‹¹ì¸µë§Œ)
                        if (canvasId === 'weeklyPartyTrendChart') {
                            return ['ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹', 'êµ­ë¯¼ì˜í˜', 'ë¬´ë‹¹ì¸µ'].includes(label);
                        }
            
                        // presChart, partyChart(5Â·6í˜ì´ì§€)ëŠ”
                        // initChart í˜¸ì¶œ ì‹œ useLabels=false ë¡œ ì˜¤ë¯€ë¡œ ì—¬ê¸°ê¹Œì§€ ì•„ì˜ˆ ì•ˆ ë“¤ì–´ì˜´
                        return false;
                    },
                    color: '#333',
                    font: { size: 11 },
                    // ì´í•˜ formatter / align / offset ê·¸ëŒ€ë¡œ ìœ ì§€
                    formatter: function(value, context) {
                        // 1í˜ì´ì§€: ì§ë¬´ ì£¼ê°„
                        if (canvasId === 'weeklyTrendChart') {
                            if (currentWeeklyTrendMode === 'realmeter') {
                                return value.toFixed(1);
                            } else {
                                return Number.isInteger(value) ? value.toString() : value.toFixed(1);
                            }
                        }
                        // 2í˜ì´ì§€: ì •ë‹¹ ì£¼ê°„
                        if (canvasId === 'weeklyPartyTrendChart') {
                            if (currentWeeklyPartyMode === 'realmeter') {
                                return value.toFixed(1);
                            } else {
                                return Number.isInteger(value) ? value.toString() : value.toFixed(1);
                            }
                        }
                        // ë‚˜ë¨¸ì§€ ì°¨íŠ¸ë“¤
                        return Number.isInteger(value) ? value.toString() : value.toFixed(1);
                    },
                    align: function(context) {
                        const label = context.dataset.label;
            
                        // 1í˜ì´ì§€(ì§ë¬´ ì£¼ê°„): ê¸ì • ìœ„, ë¶€ì • ì•„ë˜
                        if (canvasId === 'weeklyTrendChart') {
                            if (label === 'ê¸ì •') return 'end';
                            if (label === 'ë¶€ì •') return 'start';
                        }
            
                        // 3í˜ì´ì§€(ì§ë¬´ ì›”ê°„): ê¸ì • í‰ê°€ ìœ„, ë¶€ì • í‰ê°€ ì•„ë˜
                        if (canvasId === 'presChartFull') {
                            if (label.includes('ê¸ì •')) return 'end';
                            if (label.includes('ë¶€ì •')) return 'start';
                        }
            
                        // 3í˜ì´ì§€ ì •ë‹¹ ì›”ê°„ + 2í˜ì´ì§€ ì •ë‹¹ ì£¼ê°„
                        // êµ­ë¯¼ì˜í˜ ì•„ë˜, ë¯¼ì£¼ë‹¹/ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹/ë¬´ë‹¹ì¸µ ìœ„
                        if (canvasId === 'partyChartFull' || canvasId === 'weeklyPartyTrendChart') {
                            if (label === 'êµ­ë¯¼ì˜í˜') return 'start'; // ì•„ë˜
                            if (label === 'ë¯¼ì£¼ë‹¹' || label === 'ë”ë¶ˆì–´ë¯¼ì£¼ë‹¹' || label === 'ë¬´ë‹¹ì¸µ') {
                                return 'end';                        // ìœ„
                            }
                        }
            
                        return 'end';
                    },
                    offset: 5
                };
            }

            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: initialDatasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    layout: { padding: { left: 10, right: 20, top: useDataLabels ? 25 : 10 } },
                    plugins: plugins,
                    scales: {
                        y: {
                            min: yMin, 
                            max: yMax, 
                            grid: { color: '#e0e0e0', drawBorder: false },
                            ticks: { stepSize: 10, font: { size: 11 } }
                        },
                        x: {
                            offset: true,
                            grid: { display: false },
                            ticks: { font: { size: 12 } }
                        }
                    },
                    elements: {
                        line: { tension: 0 }
                    }
                },
                plugins: useDataLabels ? [ChartDataLabels] : []
            });
        }

        
        // 4í˜ì´ì§€: ì§ë¬´ í‰ê°€ ì°¨íŠ¸ ë°ì´í„° ì—…ë°ì´íŠ¸ (ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ í´ë¦­ ì‹œ)
        function updatePresView(mode, btnElement) {
            pres_controls.querySelectorAll('.btn').forEach(btn => btn.classList.remove('active'));
            if (btnElement) {
                btnElement.classList.add('active');
                btnElement.dataset.mode = mode;
            }
        
            const newDatasets = [pres_totalData_Partial];
        
            if (pres_categories_Partial[mode]) {
                pres_categories_Partial[mode].forEach(ds => {
                    newDatasets.push(Object.assign({}, ds, {
                        tension: 0,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        order: 2
                    }));
                });
            }
            
            if (!presChart) {
                // presChartë§Œ ìƒì„± (ë ˆì´ë¸” off)
                presChart = initChart('presChart', labelsPartial, newDatasets, 20, 90, false);
            } else {
                presChart.data.datasets = newDatasets;
                presChart.update();
            }
        }


        // -----------------------------------------------------------
        // â­ï¸ ìŠ¬ë¼ì´ë“œ ì „í™˜ ë° í‘œì‹œ ì—…ë°ì´íŠ¸ (ì „ì²´ 6í˜ì´ì§€ë¡œ ë³€ê²½)
        // -----------------------------------------------------------
        function updateSlideDisplay(index) {
            // 1) ì¸ë±ìŠ¤ ê°€ë“œ
            if (index < 0 || index >= slideOrder.length) return;

            // 2) ì „ì²´ ìˆ¨ê¹€
            document.querySelectorAll('.slide-container').forEach(slide => {
                slide.classList.add('hidden');
            });

            // 3) í˜„ì¬ ìŠ¬ë¼ì´ë“œ í‘œì‹œ (ID ì¡´ì¬ ì—¬ë¶€ ì²´í¬)
            const slideId = slideOrder[index];
            const slideEl = document.getElementById(slideId);

            if (!slideEl) {
                console.error(`[updateSlideDisplay] ìŠ¬ë¼ì´ë“œ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${slideId}`);
                // ìµœì†Œí•œ ë„¤ë¹„ UIëŠ” ì—…ë°ì´íŠ¸í•˜ê³  ì¢…ë£Œ
                pageIndicator.textContent = `${index + 1} / ${slideOrder.length}`;
                navPrev.disabled = (index === 0);
                navNext.disabled = (index === slideOrder.length - 1);
                return;
            }

            slideEl.classList.remove('hidden');

            // 4) ë„¤ë¹„ UI ì—…ë°ì´íŠ¸ (í•˜ë“œì½”ë”© ì œê±°)
            pageIndicator.textContent = `${index + 1} / ${slideOrder.length}`;
            navPrev.disabled = (index === 0);
            navNext.disabled = (index === slideOrder.length - 1);

            // 5) ì°¨íŠ¸/ë Œë”ë§: í•„ìš”í•œ ìŠ¬ë¼ì´ë“œì—ì„œë§Œ ì‹¤í–‰
            switch (slideId) {
                case 'weekly-trend-slide': // 1í˜ì´ì§€: ì§ë¬´ ì£¼ê°„
                if (!weeklyTrendData.labels) loadWeeklyTrendChart();
                else updateWeeklyTrendView(
                    document.querySelector('#weekly-trend-controls .btn.active')?.dataset.mode,
                    document.querySelector('#weekly-trend-controls .btn.active')
                );
                break;

                case 'party-trend-slide': // 2í˜ì´ì§€: ì •ë‹¹ ì£¼ê°„
                if (!weeklyPartyTrendData.gallup) loadWeeklyPartyTrendChart();
                else updateWeeklyPartyTrendView(
                    document.querySelector('#party-trend-controls .btn.active')?.dataset.mode,
                    document.querySelector('#party-trend-controls .btn.active')
                );
                break;

                case 'pres-slide-full': // 3í˜ì´ì§€: ì§ë¬´ ì›”ê°„
                if (!presChartFull) presChartFull = initChart('presChartFull', labelsFull, pres_data_Full, 0, 90);
                else presChartFull.update();
                break;

                case 'party-slide-full': // 4í˜ì´ì§€: ì •ë‹¹ ì›”ê°„
                if (!partyChartFull) partyChartFull = initChart('partyChartFull', labelsFull, partyData_Full, 0, 50);
                else partyChartFull.update();
                break;

                case 'pres-slide': { // 5í˜ì´ì§€: ì§ë¬´ ì„¸ë¶€
                const currentActiveBtn = pres_controls?.querySelector('.btn.active');
                updatePresView(currentActiveBtn ? (currentActiveBtn.dataset.mode || 'total') : 'total', currentActiveBtn);
                break;
                }

                case 'party-slide': // 6í˜ì´ì§€: ì •ë‹¹ ì„¸ë¶€
                if (!partyChart) partyChart = initChart('partyChart', labelsPartial, partyData_Partial, 0, 50, false);
                else partyChart.update();
                break;

                case 'policy-title-slide': // 7í˜ì´ì§€: ì„¹ì…˜ íƒ€ì´í‹€
                // ë Œë”ë§ ì—†ìŒ
                break;

                // âœ… ì¶”ê°€ëœ ê°œë… ìŠ¬ë¼ì´ë“œ 3ì¥
                case 'slide-yk-1':
                case 'slide-yk-2':
                case 'slide-yk-3':
                // ì°¨íŠ¸ ì—†ìŒ (ë Œë”ë§ ì—†ìŒ)
                break;

                case 'policy-econ-slide': // ì´í›„ í˜ì´ì§€
                if (!chartEcon) chartEcon = createEconChart();
                else chartEcon.update();
                break;
                case 'policy-negative-exp-slide': 
                if (!chartNegativeExp) {chartNegativeExp = createNegativeExpChart();
                } else {chartNegativeExp.update(); }
                break;
                case 'policy-risk-slide':
                if (!chartRisk) chartRisk = createRiskCombinedChart();
                else chartRisk.update();
                break;

                case 'policy-welfare-slide':
                if (!chartWelfare) chartWelfare = createWelfareChart();
                else chartWelfare.update();
                break;

                case 'policy-solution-slide':
                // ì°¨íŠ¸ ì—†ìŒ
                break;

                default:
                // í˜¹ì‹œ slideOrderì— ìƒˆ IDë¥¼ ì¶”ê°€í–ˆëŠ”ë° caseë¥¼ ë¹¼ë¨¹ì–´ë„, í™”ë©´ì€ ë‚˜ì˜¤ê²Œ ë‘ê¸°
                console.warn(`[updateSlideDisplay] switch ì²˜ë¦¬ë˜ì§€ ì•Šì€ ìŠ¬ë¼ì´ë“œ: ${slideId}`);
                break;
            }
        }


        // â­ï¸ í™”ì‚´í‘œë¥¼ í†µí•œ ìŠ¬ë¼ì´ë“œ ì´ë™ í•¨ìˆ˜
        function navigateSlides(direction) {
            let newIndex = currentSlideIndex + direction;

            if (newIndex >= 0 && newIndex < slideOrder.length) {
                currentSlideIndex = newIndex;
                updateSlideDisplay(currentSlideIndex);
            }
        }
        
        // ì´ˆê¸° ë¡œë“œ ì‹œ ì²« ë²ˆì§¸ ìŠ¬ë¼ì´ë“œ í™œì„±í™”
        document.addEventListener('DOMContentLoaded', () => {
            updateSlideDisplay(currentSlideIndex);
        });
    </script>

</body>
</html>
